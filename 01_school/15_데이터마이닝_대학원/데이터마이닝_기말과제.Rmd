---
title: "데이터마이닝 - 기말과제"
output:
  word_document: default
  html_notebook: default
  pdf_document: default
  html_document: default
---

## 성 명: 지 용 기
## 연 락 처: 010-9828-0332, braveji@hanmail.net
## 학 번: 201685-010100

---

## 9강-1번 문제 
### 아래 그림과 같은 범주형 변수를 고려해 보자.
![](09_01.jpg)

총 관찰치의 수는 18개이며 흰색집단에 10개, 검정색집단에 8개의 관찰치가 포함되어 있다. 이 데이터에 CART방법의 지니지수를 이용하여 분할집합을 찾으려 한다.
아래와 같은 표를 채우고, 최적의 분할집합을 찾으라.

지니 지수( Gini Index )
$$
\boldsymbol{\phi = 	\sum_{j}P_j(g)(1-P_j(g)) }
$$

좌측분할  |  우측분할 | 지니지수 
----------|-----------|----------
   a      |  b,   c   | <span style="color:red">0.4722222</span>
   b      |  a,   c   | <span style="color:red">0.4085207</span>
   c      |  a,   b   | <span style="color:red">0.4024287</span>

첫번째 지니지수 

\\( P_a = (4/6) * ( 1 - (4/6) ) \\)  =  `r  (4/6) * ( 1 - (4/6) ) `

\\( P_{bc} = (6/12) * ( 1 - (6/12) ) \\)  =  `r  (6/12) * ( 1 - (6/12) ) ` 

\\( P_a + P_{bc} = (4/6) * ( 1 - (4/6) ) + (6/12) * ( 1 - (6/12) )  \\) = `r (4/6) * ( 1 - (4/6) ) + (6/12) * ( 1 - (6/12) )`


두번째 지니지수 

\\( P_b = (4/5) * ( 1 - (4/5) ) \\)  =  `r  (4/5) * ( 1 - (4/5) ) `

\\( P_{ac} = (6/13) * ( 1 - (6/13) ) \\)  =  `r  (6/13) * ( 1 - (6/13) ) `

\\( P_b + P_{ac} = (4/5) * ( 1 - (4/5) ) + (6/13) * ( 1 - (6/13) ) \\)  =  `r (4/5) * ( 1 - (4/5) ) + (6/13) * ( 1 - (6/13) ) ` 


세번째 지니지수 

\\( P_c = (2/7) * ( 1 - (2/7) ) \\)  =  `r  (2/7) * ( 1 - (2/7) ) `

\\( P_{ab} = (8/11) * ( 1 - (8/11) ) \\)  =  `r  (8/11) * ( 1 - (8/11) ) `

\\( P_c + P_{ab} = (2/7) * ( 1 - (2/7) ) +  (8/11) * ( 1 - (8/11) ) \\)  =  `r (2/7) * ( 1 - (2/7) ) +  (8/11) * ( 1 - (8/11) ) `


<span style="color:red">  최적의 분할집합은 세번째 좌측분할(c), 우측분할(a,b)  임. </span>


---

## 10강-1번 문제
### 두 종류의 농작물 벼룩(flea beetle)에 대하여 다음의 네 가지 변수의 값을 측정하였다. 

### X1 = 앞가슴의 가늘고 긴 흠의 길이(단위 : microns)
### X2 = 굳은 날개의 길이(단위 : 0.01mm)
### X3 = 두 번째 더듬이 관절의 길이(단위 : microns)
### X4 = 세 번째 더듬이 관절의 길이(단위 : microns)

### 다음 표본 데이터를 이용하여 임의로 잡힌 벼룩이 어떤 종류의 벼룩인지 식별하기 위한 나무모형 분석을 실시하고, 결과를 해석하시오. 


```{r} 
fleaBeetle <- read.csv('10_01.csv', header = TRUE)
head( fleaBeetle )
summary(fleaBeetle)
```




```{r}
library(rpart)
fleaBeetle.tr <- rpart(species~. , data=fleaBeetle , method="class")
summary( fleaBeetle.tr )
fleaBeetle.tr
```


```{r}
# 깔끔한 결정나무 그리기
#install.packages('rattle', repo="http://cran.nexr.com/")
#install.packages('rpart.plot', repo="http://cran.nexr.com/")
#install.packages('RColorBrewer', repo="http://cran.nexr.com/")

library(rattle)				# Fancy tree plot
library(rpart.plot)			# Enhanced tree plots
library(RColorBrewer)			# Color selection for fancy tree 
 
fancyRpartPlot(fleaBeetle.tr)
```



- 3개의 종단노드가 있고
- 1)루트노드에는 carduorum 39개, oleracea 19개가 있음.
    - 2)노드에서 x3 > 152 일때, carduorum 13개, oleracea 0개로 분류되는 종단노드이며,
    - 3)노드에서 x3< 152 일때, carduorum 27개, oleracea 7개로 분류되고,
        - 3)노드에서 x1< 185 일때 6노드로 분류되고 carduorum 10개, oleracea 4개
        - 3)노드에서 x1>= 185 일때 7노드로 분류되고 carduorum 17개, oleracea 1개로 분류됨.

<span style="color:red">  그러므로, X3>=153 이면  carduorum,  그러지 않을때는  x1< 185 일때는 carduorum으로   x1>=185일때는 oleracea로 분류함.</span>

---

## 10강-2번 문제
### 다음은 1986년도 미국 메이저리그 야구기록(http://stat.cmu.edu/DASL) 중에서 투수기록 자료 중 50개를 임의로 택한 자료이다. 연봉에 영향을 미칠 수 있는 변수로서 고려한 변수들은 (승수, … ,총구원승수)의 13개로 마지막 변수는 87년도 연봉자료이다. 자료를 3등분한 뒤, 처음 두 자료를 이용하여 연봉자료를 예측할 수 있는 나무모형 분석을 실시하고, 적합된 나무모형을 이용하여 나머지 자료의 연봉을 예측하여 보시오. 


```{r} 
majorPitcher <- read.csv('10_02.csv', header = TRUE)
head( majorPitcher )
summary(majorPitcher)
```



```{r}
set.seed(3) # 재현성을 위해서 seed(3)으로 함.
seq_train <- sample( 1:nrow(majorPitcher), 35  )
seq_train

majorPitcher.train <- majorPitcher[seq_train,]
majorPitcher.test <- majorPitcher[-seq_train,]


majorPitcher.train.fit <- rpart(Salary ~. , method="anova", data=majorPitcher.train )
majorPitcher.train.fit 


fancyRpartPlot(majorPitcher.train.fit)
```

- Totwins>=51.5 이면, 연봉은 1188.8890 이며 아니면, Totwins< 27.5 일때는 연봉 159.2333,  Totwins>=27.5 일때는 68.4545 임.

```{r}
table(
    predict(majorPitcher.train.fit, majorPitcher.test, type = "vector"), 
    majorPitcher.test$Salary )
```


- 14번째 데이터인 연봉700을   연봉 568.45으로 잘못 예측하고 나머지는 대략적으로 잘 맞춘것으로 파악됨.
- 주의) set.seed(3) 값이 달라지면, 결과도 달라짐.

---

## 11강-3번 문제
### iris 자료를 이용하여 setosa종 여부를 판정하는 나무모형을 R를 이용하여 작성하고 분석하시오.

```{r}
summary( iris )
```




12강 연습문제 3번, 4번
13강 연습문제 1번, 5번
14강 연습문제 4번 




